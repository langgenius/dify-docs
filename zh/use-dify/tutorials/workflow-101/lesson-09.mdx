---
title: "第 9 课：排版设计师（模板）"
sidebarTitle: 第 9 课
---


回顾第八课，我们使用最后的 LLM 节点产出一篇完整的回复邮件。虽然，我们在这个 LLM 节点内的 Prompt 里告知了邮件内需要每一个问题对应一个答案，但仍然会有每封邮件输出格式不统一的情况。我们需要在这个 LLM 节点之前，将答案列表整理成一段格式清晰、且易于阅读的文本块，比如：带编号或者项目符号的列表。

## 模版转换
你可以将它理解成排版设计师，它能够接收一个或者多个输入变量（比如我们的答案列表），然后按照你设置好的模版，将这些变量重新组合、排版，最终输出一段格式统一的文本。

### 动手实践 优化邮件排版
1. 添加节点  
	在迭代节点和 LLM 节点之间，新增模版转换节点。
<Frame>
  <img src="/images/difyworkflow101-lesson09-addthenode.png" alt="Add the node" />
</Frame>

2. 配置模版转换节点  
	我们需要告诉模板转换节点，它要处理的数据（答案列表）是什么。  
	a. 点击模版转换节点，来到右侧的配置面板
	b. 输入变量：点击选择`迭代/\{x} output`，将其命名为 answers。
<Frame>
  <img src="/images/difyworkflow101-lesson10-setinputs.png" alt="Set inputs" />
</Frame>
  - 在代码区域，我们需要使用 Jinja2 指令，将输入变量转换成我们想要的格式。

**什么是 Jinja2?**
简单来说，Jinja2 就是一种让你把变量（比如答案列表）按照你想要的格式，填入到一个文本模板里的工具。它使用一些简单的符号来标记变量的位置和执行一些基本操作。通过它，我们能把一个原始的数据列表，转换成一段格式整齐的文本。
你可以在代码框中输入以下内容（可直接复制粘贴），这部分的代码含义是
依次处理 answers 列表中的每一项，并在每一项前面加上“- ”，最终生成一个项目符号列表。
```
{% for answer in answers %}
- {{ answer }}
{% endfor %}
```

3. 更新 LLM 的提示词  
	现在我们需要在原本的 System 里，修改为基于模版转换节点的输出进行邮件编写。你可以使用下面的提示词或自行进行修改。  

	Please generate a clear and complete email reply for `User Input/{x}customer_name` using the following prepared answers: `Template/{x}output`.
	Please start with a friendly greeting and sign off as Anne.
<Frame>
  <img src="/images/difyworkflow101-lesson09-updateprompt.png" alt="Update prompt" />
</Frame>
这是最终的工作流。
<Frame>
  <img src="/images/difyworkflow101-lesson09-finalworkflow.png" alt="Final workflow" />
</Frame>

## 小挑战和延展思考
1. 如何修改 Jinja2 的语法，将项目符号列表修改成数字编号列表。
提示：可前往 [Template Designer Documentation](https://jinja.palletsprojects.com/en/stable/templates/)，或者向 AI 提问，探索更多格式。
2. 格式转换除了对列表进行统一的格式处理，还能做什么？