{
  "openapi": "3.0.1",
  "info": {
    "title": "高度なチャットアプリ API",
    "description": "チャットアプリケーションはセッションの永続化をサポートしており、以前のチャット履歴を応答のコンテキストとして使用できます。これはチャットボット、カスタマーサービス AI などに適用できます。このバージョンには、ワークフローイベントやより詳細なファイルタイプのサポートなどの高度な機能が含まれています。",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "{api_base_url}",
      "description": "高度なチャットアプリ API のベース URL。{api_base_url} をアプリケーションに提供された実際の API ベース URL（例：props.appDetail.api_base_url から取得）に置き換えてください。",
      "variables": {
        "api_base_url": {
          "default": "https://api.dify.ai/v1",
          "description": "API の実際のベース URL"
        }
      }
    }
  ],
  "security": [
    {
      "ApiKeyAuth": []
    }
  ],
  "paths": {
    "/chat-messages": {
      "post": {
        "summary": "チャットメッセージを送信",
        "description": "高度なチャットアプリケーションにリクエストを送信します。さまざまなファイルタイプとワークフローイベントをサポートしています。",
        "operationId": "sendAdvancedChatMessage",
        "tags": [
          "Chatflow"
        ],
        "requestBody": {
          "description": "高度なチャットメッセージを送信するためのリクエストボディ。",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdvancedChatRequest"
              },
              "examples": {
                "streaming_with_file_and_workflow": {
                  "summary": "画像ファイル付きストリーミングモードの例",
                  "value": {
                    "inputs": {
                      "user_name": "Alice"
                    },
                    "query": "Analyze this document and tell me its sentiment.",
                    "response_mode": "streaming",
                    "conversation_id": "conv_12345",
                    "user": "user_alice",
                    "files": [
                      {
                        "type": "document",
                        "transfer_method": "remote_url",
                        "url": "https://example.com/mydoc.pdf"
                      }
                    ],
                    "auto_generate_name": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功レスポンス。コンテンツタイプと構造は `response_mode` によって異なります。\n- `blocking`: `ChatCompletionResponse` を含む `application/json`。\n- `streaming`: `ChunkAdvancedChatEvent` ストリームを含む `text/event-stream`。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatCompletionResponse"
                }
              },
              "text/event-stream": {
                "schema": {
                  "type": "string",
                  "description": "Server-Sent Events のストリーム。構造については `ChunkAdvancedChatEvent` を参照してください。"
                },
                "examples": {
                  "workflow_events_example": {
                    "summary": "ワークフローイベントを含むストリームの例",
                    "value": "data: {\"event\": \"workflow_started\", \"task_id\": \"task_abc\", \"workflow_run_id\": \"wf_run_1\", \"data\": {\"id\": \"wf_run_1\", \"workflow_id\": \"wf_def_xyz\", \"sequence_number\": 1, \"created_at\": 1705395332}}\n\ndata: {\"event\": \"node_started\", \"task_id\": \"task_abc\", \"workflow_run_id\": \"wf_run_1\", \"data\": {\"id\": \"node_run_1\", \"node_id\": \"node_start\", \"node_type\": \"start\", \"title\": \"Start Node\", \"index\": 0, \"inputs\": {}, \"created_at\": 1705395333}}\n\ndata: {\"event\": \"message\", \"task_id\": \"task_abc\", \"message_id\": \"msg_123\", \"conversation_id\": \"conv_123\", \"answer\": \"Processing... \", \"created_at\": 1705395334}\n\ndata: {\"event\": \"node_finished\", \"task_id\": \"task_abc\", \"workflow_run_id\": \"wf_run_1\", \"data\": {\"id\": \"node_run_1\", \"node_id\": \"node_start\", \"node_type\": \"start\", \"title\": \"Start Node\", \"index\": 0, \"status\": \"succeeded\", \"elapsed_time\": 0.5, \"created_at\": 1705395333}}\n\ndata: {\"event\": \"message_end\", \"task_id\": \"task_abc\", \"message_id\": \"msg_123\", \"conversation_id\": \"conv_123\", \"metadata\": {\"usage\": {\"total_tokens\": 10}}}\n\ndata: {\"event\": \"workflow_finished\", \"task_id\": \"task_abc\", \"workflow_run_id\": \"wf_run_1\", \"data\": {\"id\": \"wf_run_1\", \"workflow_id\": \"wf_def_xyz\", \"status\": \"succeeded\", \"elapsed_time\": 2.5, \"total_tokens\": 150, \"total_steps\": 3, \"created_at\": 1705395332, \"finished_at\": 1705395335}}\n\n"
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequestGeneric"
          },
          "404": {
            "$ref": "#/components/responses/ConversationNotFound"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/files/upload": {
      "post": {
        "summary": "ファイルアップロード",
        "description": "メッセージ送信時に使用するファイルをアップロードし、マルチモーダル理解を有効にします。アプリケーションでサポートされている任意の形式をサポートしています。アップロードされたファイルは現在のエンドユーザーのみが使用できます。",
        "operationId": "uploadAdvancedChatFile",
        "tags": [
          "Files"
        ],
        "requestBody": {
          "description": "ファイルアップロードリクエスト。multipart/form-data が必要です。",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file",
                  "user"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "アップロードするファイル。"
                  },
                  "user": {
                    "type": "string",
                    "description": "ユーザー識別子、アプリケーション内で一意。**注意**: Service API は WebApp で作成された会話を共有しません。API を通じて作成された会話は、WebApp インターフェースで作成された会話とは分離されています。"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ファイルが正常にアップロードされました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileUploadResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequestFile"
          },
          "413": {
            "$ref": "#/components/responses/FileTooLarge"
          },
          "415": {
            "$ref": "#/components/responses/UnsupportedFileTypeFile"
          },
          "503": {
            "$ref": "#/components/responses/S3ErrorFile"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/files/{file_id}/preview": {
      "get": {
        "summary": "ファイルプレビュー",
        "description": "アップロードされたファイルをプレビューまたはダウンロードします。このエンドポイントを使用すると、ファイルアップロード API を介して以前にアップロードされたファイルにアクセスできます。ファイルは、リクエストしているアプリケーション内のメッセージに属している場合にのみアクセスできます。",
        "operationId": "previewChatFlowFile",
        "tags": [
          "Files"
        ],
        "parameters": [
          {
            "name": "file_id",
            "in": "path",
            "required": true,
            "description": "プレビューするファイルの一意の識別子。ファイルアップロード API のレスポンスから取得します。",
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "as_attachment",
            "in": "query",
            "required": false,
            "description": "ファイルを添付ファイルとして強制ダウンロードするかどうか。デフォルトは `false`（ブラウザでプレビュー）。",
            "schema": {
              "type": "boolean",
              "default": false
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ファイルコンテンツが正常に返されました。ヘッダーはファイルタイプとリクエストパラメータに基づいて設定されます。",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "image/jpeg": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "image/webp": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "image/gif": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            },
            "headers": {
              "Content-Type": {
                "description": "ファイルの MIME タイプ",
                "schema": {
                  "type": "string"
                }
              },
              "Content-Length": {
                "description": "ファイルサイズ（バイト単位、利用可能な場合）",
                "schema": {
                  "type": "integer"
                }
              },
              "Content-Disposition": {
                "description": "as_attachment=true の場合は 'attachment' に設定",
                "schema": {
                  "type": "string"
                }
              },
              "Cache-Control": {
                "description": "パフォーマンス向けのキャッシュヘッダー",
                "schema": {
                  "type": "string",
                  "example": "public, max-age=3600"
                }
              },
              "Accept-Ranges": {
                "description": "オーディオ/ビデオファイルの場合は 'bytes' に設定",
                "schema": {
                  "type": "string",
                  "example": "bytes"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request。可能なエラーコード：\n- `invalid_param`: パラメータ入力が異常です。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden。可能なエラーコード：\n- `file_access_denied`: ファイルアクセスが拒否されたか、ファイルが現在のアプリケーションに属していません。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not Found。可能なエラーコード：\n- `file_not_found`: ファイルが見つからないか、削除されています。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "内部サーバーエラー。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/chat-messages/{task_id}/stop": {
      "post": {
        "summary": "高度なチャットメッセージ生成を停止",
        "description": "高度なチャットメッセージ生成タスクを停止します。ストリーミングモードでのみサポートされています。",
        "operationId": "stopAdvancedChatMessageGeneration",
        "tags": [
          "Chatflow"
        ],
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "description": "ストリーミングチャンクからのタスク ID。",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "user"
                ],
                "properties": {
                  "user": {
                    "type": "string",
                    "description": "ユーザー識別子、メッセージ送信呼び出しと一致させる必要があります。**注意**: Service API は WebApp で作成された会話を共有しません。API を通じて作成された会話は、WebApp インターフェースで作成された会話とは分離されています。"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/SuccessResult"
          }
        }
      }
    },
    "/messages/{message_id}/feedbacks": {
      "post": {
        "summary": "メッセージフィードバック",
        "description": "メッセージにフィードバックを提供します。",
        "operationId": "postAdvancedChatMessageFeedback",
        "tags": [
          "Feedback"
        ],
        "parameters": [
          {
            "name": "message_id",
            "in": "path",
            "required": true,
            "description": "メッセージ ID。",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MessageFeedbackRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/SuccessResult"
          }
        }
      }
    },
    "/app/feedbacks": {
      "get": {
        "summary": "アプリケーションのフィードバックを取得",
        "description": "アプリケーションのフィードバックを取得します。",
        "operationId": "getAdvancedChatAppFeedbacks",
        "tags": [
          "Feedback"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/PageQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "アプリケーションフィードバックのリスト。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppFeedbacksResponse"
                }
              }
            }
          }
        }
      }
    },
    "/messages/{message_id}/suggested": {
      "get": {
        "summary": "次の推奨質問",
        "description": "現在のメッセージに対する次の質問の提案を取得します。",
        "operationId": "getAdvancedSuggestedQuestions",
        "tags": [
          "Chatflow"
        ],
        "parameters": [
          {
            "name": "message_id",
            "in": "path",
            "required": true,
            "description": "メッセージ ID。",
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/UserQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "推奨質問を正常に取得しました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuggestedQuestionsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/messages": {
      "get": {
        "summary": "会話履歴メッセージを取得",
        "description": "スクロールロード形式で過去のチャット記録を返します。",
        "operationId": "getAdvancedConversationHistory",
        "tags": [
          "Conversations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConversationIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/UserQueryParam"
          },
          {
            "name": "first_id",
            "in": "query",
            "description": "現在のページの最初のチャット記録の ID（ページネーション用）。",
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/LimitQueryParamDefault20"
          }
        ],
        "responses": {
          "200": {
            "description": "会話履歴を正常に取得しました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConversationHistoryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/conversations": {
      "get": {
        "summary": "会話を取得",
        "description": "現在のユーザーの会話リストを取得します。",
        "operationId": "getAdvancedConversationsList",
        "tags": [
          "Conversations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserQueryParam"
          },
          {
            "$ref": "#/components/parameters/LastIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParamDefault20Max100"
          },
          {
            "$ref": "#/components/parameters/SortByQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "会話リストを正常に取得しました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConversationsListResponse"
                }
              }
            }
          }
        }
      }
    },
    "/conversations/{conversation_id}": {
      "delete": {
        "summary": "会話を削除",
        "description": "会話を削除します。",
        "operationId": "deleteAdvancedConversation",
        "tags": [
          "Conversations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConversationIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "user"
                ],
                "properties": {
                  "user": {
                    "type": "string",
                    "description": "ユーザー識別子。**注意**: Service API は WebApp で作成された会話を共有しません。API を通じて作成された会話は、WebApp インターフェースで作成された会話とは分離されています。"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": "会話が正常に削除されました。No Content。"
          }
        }
      }
    },
    "/conversations/{conversation_id}/name": {
      "post": {
        "summary": "会話の名前変更",
        "description": "セッションの名前を変更します。",
        "operationId": "renameAdvancedConversation",
        "tags": [
          "Conversations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConversationIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConversationRenameRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "会話の名前が正常に変更されました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConversationRenameResponse"
                }
              }
            }
          }
        }
      }
    },
    "/conversations/{conversation_id}/variables": {
      "get": {
        "summary": "会話変数を取得",
        "description": "特定の会話から変数を取得します。",
        "operationId": "getAdvancedConversationVariables",
        "tags": [
          "Conversations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConversationIdPathParam"
          },
          {
            "$ref": "#/components/parameters/UserQueryParam"
          },
          {
            "$ref": "#/components/parameters/LastIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParamDefault20Max100"
          }
        ],
        "responses": {
          "200": {
            "description": "会話変数を正常に取得しました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConversationVariablesResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/ConversationNotFound"
          }
        }
      }
    },
    "/audio-to-text": {
      "post": {
        "summary": "音声をテキストに変換",
        "description": "オーディオファイルをテキストに変換します。サポートされている形式：mp3、mp4、mpeg、mpga、m4a、wav、webm。ファイルサイズ制限：15MB。",
        "operationId": "advancedAudioToText",
        "tags": [
          "TTS"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/AudioToTextRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "オーディオをテキストに正常に変換しました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AudioToTextResponse"
                }
              }
            }
          }
        }
      }
    },
    "/text-to-audio": {
      "post": {
        "summary": "テキストをオーディオに変換",
        "description": "テキストを音声に変換します。",
        "operationId": "advancedTextToAudio",
        "tags": [
          "TTS"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TextToAudioJsonRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "オーディオファイルが正常に生成されました。",
            "content": {
              "audio/wav": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "audio/mp3": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            },
            "headers": {
              "Content-Type": {
                "schema": {
                  "type": "string",
                  "example": "audio/wav"
                }
              }
            }
          }
        }
      }
    },
    "/info": {
      "get": {
        "summary": "アプリケーション基本情報を取得",
        "operationId": "getAdvancedChatAppInfo",
        "tags": [
          "Application"
        ],
        "responses": {
          "200": {
            "description": "基本的なアプリケーション情報。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppInfoResponse"
                }
              }
            }
          }
        }
      }
    },
    "/parameters": {
      "get": {
        "summary": "アプリケーションパラメータ情報を取得",
        "operationId": "getAdvancedChatAppParameters",
        "tags": [
          "Application"
        ],
        "responses": {
          "200": {
            "description": "アプリケーションパラメータ。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatAppParametersResponse"
                }
              }
            }
          }
        }
      }
    },
    "/meta": {
      "get": {
        "summary": "アプリケーションメタ情報を取得",
        "operationId": "getAdvancedChatAppMeta",
        "tags": [
          "Application"
        ],
        "responses": {
          "200": {
            "description": "アプリケーションメタ情報（ツールアイコン）。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppMetaResponse"
                }
              }
            }
          }
        }
      }
    },
    "/site": {
      "get": {
        "summary": "アプリケーション WebApp 設定を取得",
        "operationId": "getAdvancedChatWebAppSettings",
        "tags": [
          "Application"
        ],
        "responses": {
          "200": {
            "description": "WebApp 設定。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebAppSettingsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/apps/annotations": {
      "get": {
        "summary": "アノテーションリストを取得",
        "operationId": "getAdvancedAnnotationList",
        "tags": [
          "Annotations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/PageQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParamDefault20Max100"
          }
        ],
        "responses": {
          "200": {
            "description": "アノテーションリスト。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnnotationListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "アノテーションを作成",
        "operationId": "createAdvancedAnnotation",
        "tags": [
          "Annotations"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAnnotationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "アノテーションが作成されました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnnotationItem"
                }
              }
            }
          },
          "201": {
            "description": "アノテーションが作成されました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnnotationItem"
                }
              }
            }
          }
        }
      }
    },
    "/apps/annotations/{annotation_id}": {
      "put": {
        "summary": "アノテーションを更新",
        "operationId": "updateAdvancedAnnotation",
        "tags": [
          "Annotations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AnnotationIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAnnotationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "アノテーションが更新されました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnnotationItem"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "アノテーションを削除",
        "operationId": "deleteAdvancedAnnotation",
        "tags": [
          "Annotations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AnnotationIdPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "アノテーションが削除されました。"
          }
        }
      }
    },
    "/apps/annotation-reply/{action}": {
      "post": {
        "summary": "アノテーション返信設定の初期化",
        "operationId": "initialAdvancedAnnotationReplySettings",
        "tags": [
          "Annotations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AnnotationActionPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InitialAnnotationReplySettingsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "タスクが開始されました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InitialAnnotationReplySettingsResponse"
                }
              }
            }
          },
          "202": {
            "description": "タスクが受け入れられました。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InitialAnnotationReplySettingsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/apps/annotation-reply/{action}/status/{job_id}": {
      "get": {
        "summary": "アノテーション返信設定初期化タスクのステータスを照会",
        "operationId": "getAdvancedInitialAnnotationReplySettingsStatus",
        "tags": [
          "Annotations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AnnotationActionPathParam"
          },
          {
            "$ref": "#/components/parameters/JobIdPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "タスクステータス。",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InitialAnnotationReplySettingsStatusResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "API_KEY",
        "description": "API キー認証。"
      }
    },
    "parameters": {
      "PageQueryParam": {
        "name": "page",
        "in": "query",
        "description": "ページ番号。",
        "schema": {
          "type": "integer",
          "default": 1
        }
      },
      "LimitQueryParam": {
        "name": "limit",
        "in": "query",
        "description": "1ページあたりのアイテム数。",
        "schema": {
          "type": "integer"
        }
      },
      "LimitQueryParamDefault20": {
        "name": "limit",
        "in": "query",
        "description": "1ページあたりのアイテム数。",
        "schema": {
          "type": "integer",
          "default": 20
        }
      },
      "LimitQueryParamDefault20Max100": {
        "name": "limit",
        "in": "query",
        "description": "1ページあたりのアイテム数（デフォルト20、最大100）。",
        "schema": {
          "type": "integer",
          "default": 20,
          "minimum": 1,
          "maximum": 100
        }
      },
      "UserQueryParam": {
        "name": "user",
        "in": "query",
        "required": true,
        "description": "ユーザー識別子。**注意**: Service API は WebApp で作成された会話を共有しません。API を通じて作成された会話は、WebApp インターフェースで作成された会話とは分離されています。",
        "schema": {
          "type": "string"
        }
      },
      "ConversationIdQueryParam": {
        "name": "conversation_id",
        "in": "query",
        "required": true,
        "description": "会話 ID。",
        "schema": {
          "type": "string"
        }
      },
      "LastIdQueryParam": {
        "name": "last_id",
        "in": "query",
        "description": "ページネーション用の最後のレコードの ID。",
        "schema": {
          "type": "string"
        }
      },
      "SortByQueryParam": {
        "name": "sort_by",
        "in": "query",
        "description": "ソートフィールド（例：-updated_at）。",
        "schema": {
          "type": "string",
          "enum": [
            "created_at",
            "-created_at",
            "updated_at",
            "-updated_at"
          ],
          "default": "-updated_at"
        }
      },
      "ConversationIdPathParam": {
        "name": "conversation_id",
        "in": "path",
        "required": true,
        "description": "会話 ID。",
        "schema": {
          "type": "string"
        }
      },
      "AnnotationIdPathParam": {
        "name": "annotation_id",
        "in": "path",
        "required": true,
        "description": "アノテーション ID。",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "AnnotationActionPathParam": {
        "name": "action",
        "in": "path",
        "required": true,
        "description": "アクション: 'enable' または 'disable'。",
        "schema": {
          "type": "string",
          "enum": [
            "enable",
            "disable"
          ]
        }
      },
      "JobIdPathParam": {
        "name": "job_id",
        "in": "path",
        "required": true,
        "description": "ジョブ ID。",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      }
    },
    "responses": {
      "BadRequestGeneric": {
        "description": "Bad Request。パラメータを確認してください。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "BadRequestFile": {
        "description": "ファイル操作の Bad Request。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "FileTooLarge": {
        "description": "ファイルが大きすぎます。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "UnsupportedFileTypeFile": {
        "description": "アップロードがサポートされていないファイルタイプです。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "S3ErrorFile": {
        "description": "S3 ストレージエラー。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "InternalServerError": {
        "description": "内部サーバーエラー。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "SuccessResult": {
        "description": "操作が成功しました。",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "result": {
                  "type": "string",
                  "example": "success"
                }
              }
            }
          }
        }
      },
      "ConversationNotFound": {
        "description": "会話が見つかりません。",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      }
    },
    "schemas": {
      "AdvancedChatRequest": {
        "type": "object",
        "required": [
          "query",
          "user"
        ],
        "properties": {
          "query": {
            "type": "string",
            "description": "ユーザー入力/質問内容。"
          },
          "inputs": {
            "type": "object",
            "description": "アプリ変数のキー/値ペア。ファイルタイプの変数の場合、値は InputFileObject である必要があります。",
            "additionalProperties": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "number"
                },
                {
                  "type": "boolean"
                },
                {
                  "$ref": "#/components/schemas/InputFileObjectAdvanced"
                }
              ]
            },
            "default": {}
          },
          "response_mode": {
            "type": "string",
            "enum": [
              "streaming",
              "blocking"
            ],
            "default": "streaming",
            "description": "レスポンスモード。Cloudflare のタイムアウトはブロッキングで100秒です。"
          },
          "user": {
            "type": "string",
            "description": "ユーザー識別子。**注意**: Service API は WebApp で作成された会話を共有しません。API を通じて作成された会話は、WebApp インターフェースで作成された会話とは分離されています。"
          },
          "conversation_id": {
            "type": "string",
            "description": "続行する会話 ID。"
          },
          "files": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InputFileObjectAdvanced"
            },
            "description": "Vision 対応モデルまたは一般的なファイル入力用のファイルリスト。"
          },
          "auto_generate_name": {
            "type": "boolean",
            "default": true,
            "description": "会話タイトルを自動生成。"
          }
        }
      },
      "InputFileObjectAdvanced": {
        "type": "object",
        "required": [
          "type",
          "transfer_method"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "document",
              "image",
              "audio",
              "video",
              "custom"
            ],
            "description": "ファイルのタイプ。'document' は TXT、MD、PDF、HTML、XLSX、DOCX、CSV、EML、MSG、PPTX、XML、EPUB をカバーします。'image' は JPG、PNG、GIF、WEBP、SVG をカバーします。'audio' は MP3、M4A、WAV、WEBM、AMR をカバーします。'video' は MP4、MOV、MPEG、MPGA をカバーします。"
          },
          "transfer_method": {
            "type": "string",
            "enum": [
              "remote_url",
              "local_file"
            ],
            "description": "転送方法、ファイル URL の場合は `remote_url` / ファイルアップロードの場合は `local_file`"
          },
          "url": {
            "type": "string",
            "format": "url",
            "description": "ファイル URL（転送方法が `remote_url` の場合）"
          },
          "upload_file_id": {
            "type": "string",
            "description": "アップロードされたファイル ID。ファイルアップロード API を通じて事前にアップロードして取得する必要があります（転送方法が `local_file` の場合）"
          }
        },
        "anyOf": [
          {
            "properties": {
              "transfer_method": {
                "enum": [
                  "remote_url"
                ]
              },
              "url": {
                "type": "string",
                "format": "url"
              }
            },
            "required": [
              "url"
            ],
            "not": {
              "required": [
                "upload_file_id"
              ]
            }
          },
          {
            "properties": {
              "transfer_method": {
                "enum": [
                  "local_file"
                ]
              },
              "upload_file_id": {
                "type": "string"
              }
            },
            "required": [
              "upload_file_id"
            ],
            "not": {
              "required": [
                "url"
              ]
            }
          }
        ],
        "example": {
          "type": "image",
          "transfer_method": "remote_url",
          "url": "https://example.com/image.png"
        }
      },
      "ChatCompletionResponse": {
        "type": "object",
        "description": "ブロッキングモードチャットのレスポンス。",
        "properties": {
          "event": {
            "type": "string",
            "example": "message"
          },
          "task_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "このレスポンスイベントの一意の ID。"
          },
          "message_id": {
            "type": "string",
            "format": "uuid"
          },
          "conversation_id": {
            "type": "string",
            "format": "uuid"
          },
          "mode": {
            "type": "string",
            "example": "chat"
          },
          "answer": {
            "type": "string"
          },
          "metadata": {
            "$ref": "#/components/schemas/ResponseMetadata"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ResponseMetadata": {
        "type": "object",
        "properties": {
          "usage": {
            "$ref": "#/components/schemas/Usage"
          },
          "retriever_resources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RetrieverResource"
            }
          }
        }
      },
      "ChunkAdvancedChatEvent": {
        "type": "object",
        "required": [
          "event"
        ],
        "properties": {
          "event": {
            "type": "string",
            "enum": [
              "message",
              "message_file",
              "message_end",
              "tts_message",
              "tts_message_end",
              "message_replace",
              "workflow_started",
              "node_started",
              "node_finished",
              "workflow_finished",
              "error",
              "ping"
            ]
          }
        },
        "discriminator": {
          "propertyName": "event",
          "mapping": {
            "message": "#/components/schemas/StreamEventAdvChatMessage",
            "message_file": "#/components/schemas/StreamEventAdvMessageFile",
            "message_end": "#/components/schemas/StreamEventAdvMessageEnd",
            "tts_message": "#/components/schemas/StreamEventAdvTtsMessage",
            "tts_message_end": "#/components/schemas/StreamEventAdvTtsMessageEnd",
            "message_replace": "#/components/schemas/StreamEventAdvMessageReplace",
            "workflow_started": "#/components/schemas/StreamEventAdvWorkflowStarted",
            "node_started": "#/components/schemas/StreamEventAdvNodeStarted",
            "node_finished": "#/components/schemas/StreamEventAdvNodeFinished",
            "workflow_finished": "#/components/schemas/StreamEventAdvWorkflowFinished",
            "error": "#/components/schemas/StreamEventAdvError",
            "ping": "#/components/schemas/StreamEventAdvPing"
          }
        }
      },
      "StreamEventBaseAdv": {
        "type": "object",
        "properties": {
          "task_id": {
            "type": "string",
            "format": "uuid"
          },
          "message_id": {
            "type": "string",
            "format": "uuid"
          },
          "conversation_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "StreamEventAdvChatMessage": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "$ref": "#/components/schemas/StreamEventBaseAdv"
          },
          {
            "type": "object",
            "required": [
              "answer"
            ],
            "properties": {
              "answer": {
                "type": "string"
              }
            }
          }
        ]
      },
      "StreamEventAdvMessageFile": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "id",
              "type",
              "belongs_to",
              "url",
              "conversation_id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "description": "ファイルタイプ（例：'image'）。"
              },
              "belongs_to": {
                "type": "string",
                "enum": [
                  "assistant"
                ]
              },
              "url": {
                "type": "string",
                "format": "url"
              },
              "conversation_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ]
      },
      "StreamEventAdvMessageEnd": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "$ref": "#/components/schemas/StreamEventBaseAdv"
          },
          {
            "type": "object",
            "required": [
              "metadata"
            ],
            "properties": {
              "metadata": {
                "$ref": "#/components/schemas/ResponseMetadata"
              }
            }
          }
        ]
      },
      "StreamEventAdvTtsMessage": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "$ref": "#/components/schemas/StreamEventBaseAdv"
          },
          {
            "type": "object",
            "required": [
              "audio"
            ],
            "properties": {
              "audio": {
                "type": "string",
                "format": "byte",
                "description": "Base64 エンコードされたオーディオ。"
              }
            }
          }
        ]
      },
      "StreamEventAdvTtsMessageEnd": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "$ref": "#/components/schemas/StreamEventBaseAdv"
          },
          {
            "type": "object",
            "required": [
              "audio"
            ],
            "properties": {
              "audio": {
                "type": "string",
                "description": "空の文字列。"
              }
            }
          }
        ]
      },
      "StreamEventAdvMessageReplace": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "$ref": "#/components/schemas/StreamEventBaseAdv"
          },
          {
            "type": "object",
            "required": [
              "answer"
            ],
            "properties": {
              "answer": {
                "type": "string",
                "description": "置換コンテンツ。"
              }
            }
          }
        ]
      },
      "StreamEventAdvWorkflowStarted": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "task_id",
              "workflow_run_id",
              "data"
            ],
            "properties": {
              "task_id": {
                "type": "string",
                "format": "uuid"
              },
              "workflow_run_id": {
                "type": "string",
                "format": "uuid"
              },
              "data": {
                "$ref": "#/components/schemas/WorkflowStartedData"
              }
            }
          }
        ]
      },
      "WorkflowStartedData": {
        "type": "object",
        "required": [
          "id",
          "workflow_id",
          "sequence_number",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "workflow_id": {
            "type": "string",
            "format": "uuid"
          },
          "sequence_number": {
            "type": "integer"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "StreamEventAdvNodeStarted": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "task_id",
              "workflow_run_id",
              "data"
            ],
            "properties": {
              "task_id": {
                "type": "string",
                "format": "uuid"
              },
              "workflow_run_id": {
                "type": "string",
                "format": "uuid"
              },
              "data": {
                "$ref": "#/components/schemas/NodeStartedData"
              }
            }
          }
        ]
      },
      "NodeStartedData": {
        "type": "object",
        "required": [
          "id",
          "node_id",
          "node_type",
          "title",
          "index",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "このノード実行インスタンスの一意の ID。"
          },
          "node_id": {
            "type": "string",
            "format": "uuid",
            "description": "ノード定義の ID。"
          },
          "node_type": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "index": {
            "type": "integer"
          },
          "predecessor_node_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "inputs": {
            "type": "object",
            "additionalProperties": true,
            "description": "ノードが使用する変数。"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "StreamEventAdvNodeFinished": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "task_id",
              "workflow_run_id",
              "data"
            ],
            "properties": {
              "task_id": {
                "type": "string",
                "format": "uuid"
              },
              "workflow_run_id": {
                "type": "string",
                "format": "uuid"
              },
              "data": {
                "$ref": "#/components/schemas/NodeFinishedData"
              }
            }
          }
        ]
      },
      "NodeFinishedData": {
        "type": "object",
        "required": [
          "id",
          "node_id",
          "node_type",
          "title",
          "index",
          "status",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "node_id": {
            "type": "string",
            "format": "uuid"
          },
          "node_type": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "index": {
            "type": "integer"
          },
          "predecessor_node_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "inputs": {
            "type": "object",
            "additionalProperties": true,
            "nullable": true
          },
          "process_data": {
            "type": "object",
            "additionalProperties": true,
            "nullable": true,
            "description": "ノード処理データ（JSON）。"
          },
          "outputs": {
            "type": "object",
            "additionalProperties": true,
            "nullable": true,
            "description": "出力コンテンツ（JSON）。"
          },
          "status": {
            "type": "string",
            "enum": [
              "running",
              "succeeded",
              "failed",
              "stopped"
            ]
          },
          "error": {
            "type": "string",
            "nullable": true
          },
          "elapsed_time": {
            "type": "number",
            "format": "float",
            "nullable": true
          },
          "execution_metadata": {
            "$ref": "#/components/schemas/NodeExecutionMetadata",
            "nullable": true
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NodeExecutionMetadata": {
        "type": "object",
        "properties": {
          "total_tokens": {
            "type": "integer",
            "nullable": true
          },
          "total_price": {
            "type": "number",
            "format": "float",
            "nullable": true,
            "description": "価格の互換性のために float を使用。MD には decimal と記載。"
          },
          "currency": {
            "type": "string",
            "nullable": true,
            "example": "USD"
          }
        }
      },
      "StreamEventAdvWorkflowFinished": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "task_id",
              "workflow_run_id",
              "data"
            ],
            "properties": {
              "task_id": {
                "type": "string",
                "format": "uuid"
              },
              "workflow_run_id": {
                "type": "string",
                "format": "uuid"
              },
              "data": {
                "$ref": "#/components/schemas/WorkflowFinishedData"
              }
            }
          }
        ]
      },
      "WorkflowFinishedData": {
        "type": "object",
        "required": [
          "id",
          "workflow_id",
          "status",
          "created_at",
          "finished_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "workflow_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string",
            "enum": [
              "running",
              "succeeded",
              "failed",
              "stopped"
            ]
          },
          "outputs": {
            "type": "object",
            "additionalProperties": true,
            "nullable": true,
            "description": "出力コンテンツ（JSON）。"
          },
          "error": {
            "type": "string",
            "nullable": true
          },
          "elapsed_time": {
            "type": "number",
            "format": "float",
            "nullable": true
          },
          "total_tokens": {
            "type": "integer",
            "nullable": true
          },
          "total_steps": {
            "type": "integer",
            "default": 0
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          },
          "finished_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "StreamEventAdvError": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object",
            "required": [
              "task_id",
              "status",
              "code",
              "message"
            ],
            "properties": {
              "task_id": {
                "type": "string",
                "format": "uuid"
              },
              "message_id": {
                "type": "string",
                "format": "uuid",
                "nullable": true,
                "description": "一般的なエラーでは常に存在するとは限りません。"
              },
              "status": {
                "type": "integer"
              },
              "code": {
                "type": "string"
              },
              "message": {
                "type": "string"
              }
            }
          }
        ]
      },
      "StreamEventAdvPing": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ChunkAdvancedChatEvent"
          },
          {
            "type": "object"
          }
        ]
      },
      "Usage": {
        "type": "object",
        "properties": {
          "prompt_tokens": {
            "type": "integer"
          },
          "prompt_unit_price": {
            "type": "string"
          },
          "prompt_price_unit": {
            "type": "string"
          },
          "prompt_price": {
            "type": "string"
          },
          "completion_tokens": {
            "type": "integer"
          },
          "completion_unit_price": {
            "type": "string"
          },
          "completion_price_unit": {
            "type": "string"
          },
          "completion_price": {
            "type": "string"
          },
          "total_tokens": {
            "type": "integer"
          },
          "total_price": {
            "type": "string"
          },
          "currency": {
            "type": "string"
          },
          "latency": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "RetrieverResource": {
        "type": "object",
        "properties": {
          "position": {
            "type": "integer"
          },
          "dataset_id": {
            "type": "string",
            "format": "uuid"
          },
          "dataset_name": {
            "type": "string"
          },
          "document_id": {
            "type": "string",
            "format": "uuid"
          },
          "document_name": {
            "type": "string"
          },
          "segment_id": {
            "type": "string",
            "format": "uuid"
          },
          "score": {
            "type": "number",
            "format": "float"
          },
          "content": {
            "type": "string"
          }
        }
      },
      "FileUploadResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "size": {
            "type": "integer"
          },
          "extension": {
            "type": "string"
          },
          "mime_type": {
            "type": "string"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "MessageFeedbackRequest": {
        "type": "object",
        "required": [
          "user"
        ],
        "properties": {
          "rating": {
            "type": "string",
            "enum": [
              "like",
              "dislike",
              null
            ],
            "nullable": true
          },
          "user": {
            "type": "string"
          },
          "content": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "AppFeedbacksResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FeedbackItem"
            }
          }
        }
      },
      "FeedbackItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "app_id": {
            "type": "string",
            "format": "uuid"
          },
          "conversation_id": {
            "type": "string",
            "format": "uuid"
          },
          "message_id": {
            "type": "string",
            "format": "uuid"
          },
          "rating": {
            "type": "string",
            "enum": [
              "like",
              "dislike",
              null
            ],
            "nullable": true
          },
          "content": {
            "type": "string"
          },
          "from_source": {
            "type": "string"
          },
          "from_end_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "from_account_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "SuggestedQuestionsResponse": {
        "type": "object",
        "properties": {
          "result": {
            "type": "string",
            "example": "success"
          },
          "data": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "ConversationHistoryResponse": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer"
          },
          "has_more": {
            "type": "boolean"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConversationMessageItem"
            }
          }
        }
      },
      "ConversationMessageItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "conversation_id": {
            "type": "string",
            "format": "uuid"
          },
          "inputs": {
            "type": "object",
            "additionalProperties": true
          },
          "query": {
            "type": "string"
          },
          "answer": {
            "type": "string"
          },
          "message_files": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MessageFileItem"
            }
          },
          "feedback": {
            "type": "object",
            "nullable": true,
            "properties": {
              "rating": {
                "type": "string",
                "enum": [
                  "like",
                  "dislike"
                ]
              }
            }
          },
          "retriever_resources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RetrieverResource"
            }
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "MessageFileItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "type": {
            "type": "string"
          },
          "url": {
            "type": "string",
            "format": "url"
          },
          "belongs_to": {
            "type": "string",
            "enum": [
              "user",
              "assistant"
            ]
          }
        }
      },
      "ConversationsListResponse": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer"
          },
          "has_more": {
            "type": "boolean"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConversationListItem"
            }
          }
        }
      },
      "ConversationListItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "inputs": {
            "type": "object",
            "additionalProperties": true
          },
          "status": {
            "type": "string"
          },
          "introduction": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          },
          "updated_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ConversationRenameRequest": {
        "type": "object",
        "required": [
          "user"
        ],
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "auto_generate": {
            "type": "boolean",
            "default": false
          },
          "user": {
            "type": "string"
          }
        }
      },
      "ConversationRenameResponse": {
        "$ref": "#/components/schemas/ConversationListItem"
      },
      "ConversationVariablesResponse": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer"
          },
          "has_more": {
            "type": "boolean"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConversationVariableItem"
            }
          }
        }
      },
      "ConversationVariableItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "value_type": {
            "type": "string"
          },
          "value": {
            "type": "string"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          },
          "updated_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AudioToTextRequest": {
        "type": "object",
        "required": [
          "file",
          "user"
        ],
        "properties": {
          "file": {
            "type": "string",
            "format": "binary",
            "description": "オーディオファイル。形式：mp3、mp4、mpeg、mpga、m4a、wav、webm。制限：15MB。"
          },
          "user": {
            "type": "string"
          }
        }
      },
      "AudioToTextResponse": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string"
          }
        }
      },
      "TextToAudioJsonRequest": {
        "type": "object",
        "required": [
          "user"
        ],
        "properties": {
          "message_id": {
            "type": "string",
            "format": "uuid",
            "description": "メッセージ ID（優先）。"
          },
          "text": {
            "type": "string",
            "description": "音声コンテンツ。"
          },
          "user": {
            "type": "string"
          },
          "streaming": {
            "type": "boolean",
            "default": false,
            "description": "true の場合、レスポンスはオーディオチャンクのストリームになります。"
          }
        },
        "description": "`user` が必要です。`message_id` または `text` を提供してください。"
      },
      "AppInfoResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "ChatAppParametersResponse": {
        "type": "object",
        "properties": {
          "opening_statement": {
            "type": "string"
          },
          "suggested_questions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "suggested_questions_after_answer": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean"
              }
            }
          },
          "speech_to_text": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean"
              }
            }
          },
          "text_to_speech": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean"
              },
              "voice": {
                "type": "string"
              },
              "language": {
                "type": "string"
              },
              "autoPlay": {
                "type": "string",
                "enum": [
                  "enabled",
                  "disabled"
                ]
              }
            }
          },
          "retriever_resource": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean"
              }
            }
          },
          "annotation_reply": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean"
              }
            }
          },
          "user_input_form": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserInputFormItem"
            }
          },
          "file_upload": {
            "type": "object",
            "properties": {
              "image": {
                "type": "object",
                "properties": {
                  "enabled": {
                    "type": "boolean"
                  },
                  "number_limits": {
                    "type": "integer"
                  },
                  "detail": {
                    "type": "string"
                  },
                  "transfer_methods": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "remote_url",
                        "local_file"
                      ]
                    }
                  }
                }
              }
            }
          },
          "system_parameters": {
            "type": "object",
            "properties": {
              "file_size_limit": {
                "type": "integer"
              },
              "image_file_size_limit": {
                "type": "integer"
              },
              "audio_file_size_limit": {
                "type": "integer"
              },
              "video_file_size_limit": {
                "type": "integer"
              }
            }
          }
        }
      },
      "UserInputFormItem": {
        "type": "object",
        "oneOf": [
          {
            "$ref": "#/components/schemas/TextInputControlWrapper"
          },
          {
            "$ref": "#/components/schemas/ParagraphControlWrapper"
          },
          {
            "$ref": "#/components/schemas/SelectControlWrapper"
          }
        ]
      },
      "TextInputControlWrapper": {
        "type": "object",
        "properties": {
          "text-input": {
            "$ref": "#/components/schemas/TextInputControl"
          }
        },
        "required": [
          "text-input"
        ]
      },
      "ParagraphControlWrapper": {
        "type": "object",
        "properties": {
          "paragraph": {
            "$ref": "#/components/schemas/ParagraphControl"
          }
        },
        "required": [
          "paragraph"
        ]
      },
      "SelectControlWrapper": {
        "type": "object",
        "properties": {
          "select": {
            "$ref": "#/components/schemas/SelectControl"
          }
        },
        "required": [
          "select"
        ]
      },
      "TextInputControl": {
        "type": "object",
        "required": [
          "label",
          "variable",
          "required"
        ],
        "properties": {
          "label": {
            "type": "string"
          },
          "variable": {
            "type": "string"
          },
          "required": {
            "type": "boolean"
          },
          "default": {
            "type": "string"
          }
        }
      },
      "ParagraphControl": {
        "type": "object",
        "required": [
          "label",
          "variable",
          "required"
        ],
        "properties": {
          "label": {
            "type": "string"
          },
          "variable": {
            "type": "string"
          },
          "required": {
            "type": "boolean"
          },
          "default": {
            "type": "string"
          }
        }
      },
      "SelectControl": {
        "type": "object",
        "required": [
          "label",
          "variable",
          "required",
          "options"
        ],
        "properties": {
          "label": {
            "type": "string"
          },
          "variable": {
            "type": "string"
          },
          "required": {
            "type": "boolean"
          },
          "default": {
            "type": "string"
          },
          "options": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "AppMetaResponse": {
        "type": "object",
        "properties": {
          "tool_icons": {
            "type": "object",
            "additionalProperties": {
              "oneOf": [
                {
                  "type": "string",
                  "format": "url"
                },
                {
                  "$ref": "#/components/schemas/ToolIconDetail"
                }
              ]
            }
          }
        }
      },
      "ToolIconDetail": {
        "type": "object",
        "properties": {
          "background": {
            "type": "string"
          },
          "content": {
            "type": "string"
          }
        }
      },
      "WebAppSettingsResponse": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "chat_color_theme": {
            "type": "string"
          },
          "chat_color_theme_inverted": {
            "type": "boolean"
          },
          "icon_type": {
            "type": "string",
            "enum": [
              "emoji",
              "image"
            ]
          },
          "icon": {
            "type": "string"
          },
          "icon_background": {
            "type": "string"
          },
          "icon_url": {
            "type": "string",
            "format": "url",
            "nullable": true
          },
          "description": {
            "type": "string"
          },
          "copyright": {
            "type": "string"
          },
          "privacy_policy": {
            "type": "string"
          },
          "custom_disclaimer": {
            "type": "string"
          },
          "default_language": {
            "type": "string"
          },
          "show_workflow_steps": {
            "type": "boolean"
          },
          "use_icon_as_answer_icon": {
            "type": "boolean"
          }
        }
      },
      "AnnotationListResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AnnotationItem"
            }
          },
          "has_more": {
            "type": "boolean"
          },
          "limit": {
            "type": "integer"
          },
          "total": {
            "type": "integer"
          },
          "page": {
            "type": "integer"
          }
        }
      },
      "AnnotationItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "question": {
            "type": "string"
          },
          "answer": {
            "type": "string"
          },
          "hit_count": {
            "type": "integer"
          },
          "created_at": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "CreateAnnotationRequest": {
        "type": "object",
        "required": [
          "question",
          "answer"
        ],
        "properties": {
          "question": {
            "type": "string"
          },
          "answer": {
            "type": "string"
          }
        }
      },
      "UpdateAnnotationRequest": {
        "type": "object",
        "required": [
          "question",
          "answer"
        ],
        "properties": {
          "question": {
            "type": "string"
          },
          "answer": {
            "type": "string"
          }
        }
      },
      "InitialAnnotationReplySettingsRequest": {
        "type": "object",
        "required": [
          "score_threshold"
        ],
        "properties": {
          "embedding_provider_name": {
            "type": "string",
            "nullable": true
          },
          "embedding_model_name": {
            "type": "string",
            "nullable": true
          },
          "score_threshold": {
            "type": "number",
            "format": "float"
          }
        }
      },
      "InitialAnnotationReplySettingsResponse": {
        "type": "object",
        "properties": {
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "job_status": {
            "type": "string"
          }
        }
      },
      "InitialAnnotationReplySettingsStatusResponse": {
        "type": "object",
        "properties": {
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "job_status": {
            "type": "string"
          },
          "error_msg": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "nullable": true
          },
          "code": {
            "type": "string",
            "nullable": true
          },
          "message": {
            "type": "string"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Chatflow",
      "description": "ワークフローイベントを含む高度なチャット操作。"
    },
    {
      "name": "Files",
      "description": "高度なチャット用のファイルアップロードとプレビュー操作。"
    },
    {
      "name": "Feedback",
      "description": "高度なチャット用のユーザーフィードバック操作。"
    },
    {
      "name": "Conversations",
      "description": "高度なチャット用の会話管理。"
    },
    {
      "name": "TTS",
      "description": "高度なチャット用の音声とテキストの変換。"
    },
    {
      "name": "Application",
      "description": "高度なチャット用のアプリケーション設定と情報。"
    },
    {
      "name": "Annotations",
      "description": "高度なチャット用のアノテーション管理。"
    }
  ]
}