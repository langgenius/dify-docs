---
title: "知识检索"
description: "Search knowledge bases for relevant information"
icon: "database"
---

<Note> ⚠️ 本文档由 AI 自动翻译。如有任何不准确之处，请参考[英文原版](/en/documentation/pages/nodes/knowledge-retrieval)。</Note>


知识检索节点从您的知识库中搜索相关信息，并返回上下文内容供下游节点使用。它通过从您的文档中提供特定信息来实现RAG（检索增强生成）应用。

<Frame caption="知识检索节点配置">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/d90961c6d794d425a8e11df177315188.png" alt="Knowledge Retrieval Node Interface" />
</Frame>

<Info>
  在使用此节点之前，请先创建并填充知识库。请参阅[知识库创建指南](/en/guides/knowledge-base/create-knowledge-and-upload-documents)获取设置说明。
</Info>

## 配置

### 查询和知识库选择

**查询**决定在您的知识库中搜索什么内容。对于对话流应用中的用户输入使用`sys.query`，或者使用工作流中的任何文本变量。查询限制为200个字符。

选择一个或多个**知识库**进行搜索。每个知识库都包含您上传到Dify的索引文档。可以使用不同策略同时搜索多个知识库。

### 检索策略

选择如何搜索您的内容：

<Tabs>
  <Tab title="语义检索">
    使用向量嵌入根据含义查找概念上相似的内容。适用于自然语言查询和使用不同术语的相关概念。
  </Tab>
  
  <Tab title="关键词检索">
    传统的全文检索，用于精确单词匹配。对于特定术语、代码或名称更快速且更可预测。
  </Tab>
  
  <Tab title="混合检索">
    结合语义和关键词方法。使用专门的模型对结果进行重新排序以获得更好的相关性。
  </Tab>
</Tabs>

## 高级设置

<Frame caption="高级检索配置选项">
  <img src="https://assets-docs.dify.ai/2025/03/fbd43d558f83b355a1b18ac26a253b84.png" alt="Knowledge retrieval configuration interface" />
</Frame>

### 检索参数

**TopK**控制要检索的文档块数量。从3-5个块开始以获得聚焦结果，或使用10-15个块以获得全面覆盖。

**分数阈值**设置最小相似度分数。更高的阈值（0.7+）确保相关性，较低的阈值（0.5-）包含更多相关的内容。

**重排序**在初始检索后重新评分结果。对于混合检索、大量块，或当精度比速度更重要时启用。

### 元数据筛选

使用文档元数据（如类型、日期或部门）筛选结果。上传文档时设置元数据，以在大型知识库中启用有针对性的搜索。

### 多知识库策略

**N对1召回**使用函数调用来分析查询、选择适当的知识库并优化搜索。最适用于不同领域的专业知识库。

**多路召回**同时查询所有选定的知识库并合并结果。当信息跨越多个来源或您需要全面覆盖时使用。

<Frame caption="多个知识库检索策略比较">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/4a3007cda9dfa50ddac3711693725dce.png" alt="Retrieval Mode Comparison" />
</Frame>

## 输出和集成

该节点输出包含文本内容和元数据（来源、分数、文档ID）的检索文档块数组。这种结构化输出保留了引用所需的信息。

### RAG集成

将知识检索输出连接到大型语言模型节点上下文输入，用于RAG应用。当使用检索结果作为上下文变量时，Dify会自动跟踪来源并启用引用功能。

```text
System: 根据提供的上下文回答。
Context: {{knowledge_retrieval.result}}
User: {{user_question}}
```

### 速率限制

知识检索操作受到基于您订统使用Redis以60秒滑动窗口跟踪请求。当超出限制时，会返回`RateLimitExceeded`错误。

### 性能考虑

检索质量取决于索引实践。较小的块（200-500个标记）能够实现精确检索，较大的块（800-1500个标记）保持上下文。知识库有速率限制——该节点处理限制并自动缓存相同的查询。