<title>Dify Chatbot â€“ full dashboard</title>
<style>
html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif}
#hdr{background:#1c64f2;color:#fff;padding:.6rem 1rem;font-size:1rem}
iframe{width:100%;height:calc(100% - 2.5rem);border:0}
</style>
Welcome, <span id="user_email">!</span>
<script src="https://cdn.jsdelivr.net/npm/pako@2/dist/pako.min.js"></script>
<script>
/* 1. grab the e-mail from the page URL (or fall back) */
const userEmail = new URLSearchParams(location.search).get('user_email') || 'guest@example.com';
/* 2. show it in the banner */
document.getElementById('user_email').textContent = userEmail;
/* 3. build the encoded "name" parameter that Dify expects */
const inputs = { user_email: userEmail }; // Note: variable name must match Dify Start node input field name
// add more keys if you wish
function pack(obj){
  const gz = pako.gzip(JSON.stringify(obj)); // gzip
  const b64 = btoa(String.fromCharCode(...gz)); // base64
  return encodeURIComponent(b64); // url-encode
}
/* 4. create the iframe src */
const src = `http://10.161.121.22/chatbot/qS96n3Fi9UZfdHNh?user_email=${pack(inputs)}`;
/* 5. inject the iframe */
document.write(`<iframe src="${src}" allow="microphone"></iframe>`);
</script>