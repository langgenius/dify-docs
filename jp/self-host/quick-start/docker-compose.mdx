---
title: Docker Compose
---

<Note> ⚠️ このドキュメントはAIによって自動翻訳されています。不正確な部分がある場合は、[英語版](/en/self-host/quick-start/docker-compose)を参照してください。</Note>


## 前提条件

> Difyをインストールする前に、お使いのマシンが以下の最小システム要件を満たしていることを確認してください：
>
> * CPU >= 2コア
> * RAM >= 4 GiB

<table>
  <thead>
    <tr>
      <th>オペレーティングシステム</th>
      <th>ソフトウェア</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>macOS 10.14以降</td>
      <td>Docker Desktop</td>
      <td>Docker仮想マシン（VM）が最低2つの仮想CPU（vCPU）と8GBの初期メモリを使用するよう設定してください。そうしないと、インストールが失敗する可能性があります。詳細については、<a href="https://docs.docker.com/desktop/mac/install/">Mac用Docker Desktopインストールガイド</a>を参照してください。</td>
    </tr>
    <tr>
      <td>Linuxプラットフォーム</td>
      <td>
        <p>Docker 19.03以降</p>
        <p>Docker Compose 1.28以降</p>
      </td>
      <td>DockerとDocker Composeのインストール方法の詳細については、<a href="https://docs.docker.com/engine/install/">Dockerインストールガイド</a>および<a href="https://docs.docker.com/compose/install/">Docker Composeインストールガイド</a>をそれぞれ参照してください。</td>
    </tr>
    <tr>
      <td>WSL 2が有効なWindows</td>
      <td>Docker Desktop</td>
      <td>Linuxコンテナにバインドされるソースコードや他のデータは、Windowsファイルシステムではなく、Linuxファイルシステムに保存することを推奨します。詳細については、<a href="https://docs.docker.com/desktop/windows/install/#wsl-2-backend">WindowsでWSL 2バックエンドを使用するDocker Desktopインストールガイド</a>を参照してください。</td>
    </tr>
  </tbody>
</table>

### Difyのクローン

Difyのソースコードをローカルマシンにクローンします：

```bash
git clone --branch "$(curl -s https://api.github.com/repos/langgenius/dify/releases/latest | jq -r .tag_name)" https://github.com/langgenius/dify.git
```

### Difyの起動

1.  Difyソースコード内のDockerディレクトリに移動します

    ```bash
    cd dify/docker
    ```
2.  環cp .env.example .env
    ```
3.  Dockerコンテナを起動します

    システムのDocker Composeバージョンに基づいて、適切なコマンドを選択してコンテナを起動してください。バージョンを確認するには`docker compose version`コマンドを使用し、詳細については[Dockerドキュメント](https://docs.docker.com/compose/install/)を参照してください：

    * Docker Compose V2を使用している場合は、以下のコマンドを使用します：

    ```bash
    docker compose up -d
    ```

    * Docker Compose V1を使用している場合は、以下のコマンドを使用します：

    ```bash
    docker-compose up -d
    ```

コマンドを実行すると、すべてのコンテナのステータスと起動時間を示す以下のような出力が表示されるはずです：

```bash
[+] Running 13/13
 ✔ Network docker_ssrf_proxy_network  Created                                                                10.0s 
 ✔ Network docker_default             Created                                                                 0.1s 
 ✔ Container docker-sandbox-1         Started                                                                 0.3s 
 ✔ Container docker-db_postgres-1     Healthy                                                                 2.8s 
 ✔ Container docker-web-1             Started                                                                 0.3s 
 ✔ Container docker-redis-1           Started                                                                 0.3s 
 ✔ Container docker-ssrf_proxy-1      Started                                                                 0.4s 
 ✔ Container docker-weaviate-1        Started                                                                 0.3s 
 ✔ Container docker-worker_beat-1     Started                                                                 3.2s 
 ✔ Container docker-api-1             Started                                                                 3.2s 
 ✔ Container docker-worker-1          Started                                                                 3.2s 
 ✔ Container docker-plugin_daemon-1   Started                                                                 3.2s 
 ✔ Container docker-nginx-1           Started   
```

最後に、すべてのコンテナが正常に動作しているかを確認します：

```bash
docker compose ps
```

これは5つのビジネスサービス `api / worker / worker_beat / web / plugin_daemon` と6つの基礎コンポーネント `weaviate / db_postgres / redis / nginx / ssrf_proxy / sandbox` を含まれます。

```bash
NAME                     IMAGE                                       COMMAND                  SERVICE         CREATED          STATUS                             PORTS
docker-api-1             langgenius/dify-api:1.10.1                  "/bin/bash /entrypoi…"   api             26 seconds ago   Up 22 seconds                      5001/tcp
docker-db_postgres-1     postgres:15-alpine                          "docker-entrypoint.s…"   db_postgres     26 seconds ago   Up 25 seconds (healthy)            5432/tcp
docker-nginx-1           nginx:latest                                "sh -c 'cp /docker-e…"   nginx           26 seconds ago   Up 22 seconds                      0.0.0.0:80->80/tcp, :::80->80/tcp, 0.0.0.0:443->443/tcp, :::443->443/tcp
docker-plugin_daemon-1   langgenius/dify-plugin-daemon:0.4.1-local   "/bin/bash -c /app/e…"   plugin_daemon   26 seconds ago   Up 22 seconds                      0.0.0.0:5003->5003/tcp, :::5003->5003/tcp
docker-redis-1           redis:6-alpine                              "docker-entrypoint.s…"   redis           26 seconds ago   Up 25 seconds (health: starting)   6379/tcp
docker-sandbox-1         langgenius/dify-sandbox:0.2.12              "/main"                  sandbox         26 seconds ago   Up 25 seconds (health: starting)   
docker-ssrf_proxy-1      ubuntu/squid:latest                         "sh -c 'cp /docker-e…"   ssrf_proxy      26 seconds ago   Up 25 seconds                      3128/tcp
docker-weaviate-1        semitechnologies/weaviate:1.27.0            "/bin/weaviate --hos…"   weaviate        26 seconds ago   Up 25 seconds                      
docker-web-1             langgenius/dify-web:1.10.1                  "/bin/sh ./entrypoin…"   web             26 seconds ago   Up 25 seconds                      3000/tcp
docker-worker-1          langgenius/dify-api:1.10.1                  "/bin/bash /entrypoi…"   worker          26 seconds ago   Up 22 seconds                      5001/tcp
docker-worker_beat-1     langgenius/dify-api:1.10.1                  "/bin/bash /entrypoi…"   worker_beat     26 seconds ago   Up 22 seconds
```

これらの手順により、Difyを正常にインストールできるはずです。

### Difyのアップグレード

difyソースコードのdockerディレクトリに移動し、以下のコマンドを実行します：

```bash
cd dify/docker
docker compose down
git pull origin main
docker compose pull
docker compose up -d
```

#### 環境変数設定の同期（重要）

* `.env.example`ファイルが更新されている場合は、必ずローカルの`.env`実際の環境に合わせて`.env`ファイルの設定項目を確認・変更してください。`.env.example`から新しい変数を`.env`ファイルに追加し、変更された値を更新する必要がある場合があります。

### Difyへのアクセス

管理者初期化ページにアクセスして、管理者アカウントを設定します：

```bash
# ローカル環境
http://localhost/install

# サーバー環境
http://your_server_ip/install
```

Difyウェブインターフェースのアドレス：

```bash
# ローカル環境
http://localhost

# サーバー環境
http://your_server_ip
```

### Difyのカスタマイズ

`.env`ファイルの環境変数値を直接編集します。その後、以下のコマンドでDifyを再起動します：

メタデータデータベースを変更するには、`DB_TYPE`を変更し、ベクトルデータベースを変更するには、`VECTOR_STORE`を変更してください。詳細については、[環境変数](https://docs.dify.ai/jp/self-host/configuration/environments)を参照してください。

```
docker compose down
docker compose up -d
```

完全な注釈付き環境変数セットは docker/.env.example で見つけることができます。

### 詳細情報

ご質問がある場合は、[FAQ](/en/self-host/quick-start/faqs)を参照してください。
